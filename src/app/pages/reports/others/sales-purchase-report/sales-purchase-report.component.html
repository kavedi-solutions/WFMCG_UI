<page-header
  class="bg-blue-600"
  [title]="PageTitle"
  [showBack]="false"
  [showAdd]="false"
></page-header>

<form class="form-field-full page-detail" [formGroup]="SalesPurchaseReportForm">
  <mat-card>
    <div class="matero-row" fxLayout.lt-sm="column" fxLayout="row">
      <div fxFlex="20%" fxFlex.lt-sm="100" class="matero-col">
        <mat-form-field appearance="legacy" color="primary">
          <mat-label>Book Type</mat-label>
          <mat-select
            formControlName="TransactionTypeID"
            (valueChange)="TransactionTypeSelectionChange($event)"
          >
            <mat-option
              *ngFor="let ttdd of transactionTypeDropDown"
              [value]="ttdd.transactionTypeID"
            >
              {{ ttdd.transactionTypeName }}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="TransactionTypeIDControlRequired"
            >Book Type is required.</mat-error
          >
        </mat-form-field>
      </div>
      <div fxFlex="4%" fxFlex.lt-sm="100" class="matero-col">
        <button
          class="sel-button"
          type="button"
          mat-raised-button
          color="primary"
          matTooltip="Select Book"
          (click)="OpenDialog('Book')"
        >
          ...
        </button>
      </div>
      <div fxFlex="15%" fxFlex.lt-sm="100" class="matero-col">
        <mat-form-field appearance="legacy" color="primary">
          <input
            matInput
            [matDatepicker]="FromDatePicker"
            placeholder="From Date"
            formControlName="FromDate"
            [min]="FromMinDate"
            [max]="FromMaxDate"
            (dateChange)="FromDateChange()"
          />
          <mat-datepicker-toggle
            matSuffix
            [for]="FromDatePicker"
            [tabIndex]="-1"
            ><mat-icon matDatepickerToggleIcon
              >keyboard_arrow_down</mat-icon
            ></mat-datepicker-toggle
          >
          <mat-datepicker #FromDatePicker></mat-datepicker>
        </mat-form-field>
      </div>
      <div fxFlex="15%" fxFlex.lt-sm="100" class="matero-col">
        <mat-form-field appearance="legacy" color="primary">
          <input
            matInput
            [matDatepicker]="ToDatePicker"
            placeholder="To Date"
            formControlName="ToDate"
            [min]="ToMinDate"
            [max]="ToMaxDate"
            (dateChange)="ToDateChange()"
          />
          <mat-datepicker-toggle matSuffix [for]="ToDatePicker" [tabIndex]="-1"
            ><mat-icon matDatepickerToggleIcon
              >keyboard_arrow_down</mat-icon
            ></mat-datepicker-toggle
          >
          <mat-datepicker #ToDatePicker></mat-datepicker>
        </mat-form-field>
      </div>
      <div fxFlex="15%" fxFlex.lt-sm="100" class="matero-col">
        <mat-form-field appearance="legacy" color="primary">
          <mat-label>Return Type</mat-label>
          <mat-select
            formControlName="ReturnTypeID"
            [disabled]="ShowReturnType"
          >
            <mat-option
              *ngFor="let sbdd of returnTypeDropDown"
              [value]="sbdd.returnTypeID"
            >
              {{ sbdd.returnTypeName }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div fxFlex="15%" fxFlex.lt-sm="100" class="matero-col m-t-12">
        <mat-slide-toggle
          color="primary"
          class="slide_toggle_style"
          formControlName="MonthWise"
          (change)="MonthWiseToggleChange($event)"
        >
          Month Wise
        </mat-slide-toggle>
      </div>
    </div>
    <div class="matero-row" fxLayout.lt-sm="column" fxLayout="row">
      <div fxFlex="12%" fxFlex.lt-sm="100" class="matero-col">
        <mat-form-field appearance="legacy" color="primary">
          <mat-label>First</mat-label>
          <mat-select
            formControlName="SelectedFirstName"
            (valueChange)="SelectedFirstNameSelectionChange($event)"
          >
            <mat-option *ngFor="let ttdd of FilterList1" [value]="ttdd.SelType">
              {{ ttdd.SelName }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div fxFlex="4%" fxFlex.lt-sm="100" class="matero-col">
        <button
          class="sel-button"
          type="button"
          mat-raised-button
          [disabled]="SelectedFirstNameControl.value == 'None'"
          color="primary"
          (click)="OpenDialog('First')"
          matTooltip="Select {{ SelectedFirstName }}"
        >
          ...
        </button>
      </div>
      <div fxFlex="12%" fxFlex.lt-sm="100" class="matero-col">
        <mat-form-field appearance="legacy" color="primary">
          <mat-label>Second</mat-label>
          <mat-select
            [disabled]="EnableDisable('2')"
            formControlName="SelectedSecondName"
            (valueChange)="SelectedSecondNameSelectionChange($event)"
          >
            <mat-option *ngFor="let ttdd of FilterList2" [value]="ttdd.SelType">
              {{ ttdd.SelName }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div fxFlex="4%" fxFlex.lt-sm="100" class="matero-col">
        <button
          class="sel-button"
          type="button"
          mat-raised-button
          [disabled]="SelectedSecondNameControl.value == 'None'"
          color="primary"
          matTooltip="Select {{ SelectedSecondName }}"
          (click)="OpenDialog('Second')"
        >
          ...
        </button>
      </div>
      <div fxFlex="12%" fxFlex.lt-sm="100" class="matero-col">
        <mat-form-field appearance="legacy" color="primary">
          <mat-label>Third</mat-label>
          <mat-select
            [disabled]="EnableDisable('3')"
            formControlName="SelectedThirdName"
            (valueChange)="SelectedThirdNameSelectionChange($event)"
          >
            <mat-option *ngFor="let ttdd of FilterList3" [value]="ttdd.SelType">
              {{ ttdd.SelName }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div fxFlex="4%" fxFlex.lt-sm="100" class="matero-col">
        <button
          class="sel-button"
          type="button"
          mat-raised-button
          [disabled]="SelectedThirdNameControl.value == 'None'"
          color="primary"
          matTooltip="Select {{ SelectedThirdName }}"
          (click)="OpenDialog('Third')"
        >
          ...
        </button>
      </div>
      <div fxFlex="12%" fxFlex.lt-sm="100" class="matero-col">
        <mat-form-field appearance="legacy" color="primary">
          <mat-label>Fourth</mat-label>
          <mat-select
            [disabled]="EnableDisable('4')"
            formControlName="SelectedFourthName"
            (valueChange)="SelectedFourthNameSelectionChange($event)"
          >
            <mat-option *ngFor="let ttdd of FilterList4" [value]="ttdd.SelType">
              {{ ttdd.SelName }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div fxFlex="4%" fxFlex.lt-sm="100" class="matero-col">
        <button
          class="sel-button"
          type="button"
          mat-raised-button
          [disabled]="SelectedFourthNameControl.value == 'None'"
          color="primary"
          matTooltip="Select {{ SelectedFourthName }}"
          (click)="OpenDialog('Fourth')"
        >
          ...
        </button>
      </div>
      <div fxFlex="12%" fxFlex.lt-sm="100" class="matero-col">
        <mat-form-field appearance="legacy" color="primary">
          <mat-label>Fifth</mat-label>
          <mat-select
            [disabled]="EnableDisable('5')"
            formControlName="SelectedFifthName"
            (valueChange)="SelectedFifthNameSelectionChange($event)"
          >
            <mat-option *ngFor="let ttdd of FilterList5" [value]="ttdd.SelType">
              {{ ttdd.SelName }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div fxFlex="4%" fxFlex.lt-sm="100" class="matero-col">
        <button
          class="sel-button"
          type="button"
          mat-raised-button
          [disabled]="SelectedFifthNameControl.value == 'None'"
          color="primary"
          matTooltip="Select {{ SelectedFifthName }}"
          (click)="OpenDialog('Fifth')"
        >
          ...
        </button>
      </div>
      <div fxFlex="12%" fxFlex.lt-sm="100" class="matero-col">
        <mat-form-field appearance="legacy" color="primary">
          <mat-label>Sixth</mat-label>
          <mat-select
            [disabled]="EnableDisable('6')"
            formControlName="SelectedSixthName"
            (valueChange)="SelectedSixthNameSelectionChange($event)"
          >
            <mat-option *ngFor="let ttdd of FilterList6" [value]="ttdd.SelType">
              {{ ttdd.SelName }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div fxFlex="4%" fxFlex.lt-sm="100" class="matero-col">
        <button
          class="sel-button"
          type="button"
          mat-raised-button
          [disabled]="SelectedSixthNameControl.value == 'None'"
          color="primary"
          matTooltip="Select {{ SelectedSixthName }}"
          (click)="OpenDialog('Sixth')"
        >
          ...
        </button>
      </div>
    </div>
    <div class="matero-row" fxLayout.lt-sm="column" fxLayout="row">
      <div fxFlex="20%" fxFlex.lt-sm="100" class="matero-col m-t-12">
        <mat-slide-toggle
          [disabled]="MonthWiseControl.value == true"
          color="primary"
          class="slide_toggle_style"
          formControlName="ShowInvoiceNo"
        >
          Show Invoice No
        </mat-slide-toggle>
      </div>
      <div fxFlex="20%" fxFlex.lt-sm="100" class="matero-col m-t-12">
        <mat-slide-toggle
          color="primary"
          [disabled]="MonthWiseControl.value == true"
          class="slide_toggle_style"
          formControlName="ShowInvoiceDate"
        >
          Show Invoice Date
        </mat-slide-toggle>
      </div>
      <div fxFlex="20%" fxFlex.lt-sm="100" class="matero-col m-t-12">
        <mat-slide-toggle
          color="primary"
          [disabled]="ShowQty"
          class="slide_toggle_style"
          formControlName="ShowQuantity"
        >
          Show Quantity
        </mat-slide-toggle>
      </div>
      <div fxFlex="20%" fxFlex.lt-sm="100" class="matero-col m-t-12">
        <mat-slide-toggle
          color="primary"
          class="slide_toggle_style"
          formControlName="ShowAmount"
        >
          Show Amount
        </mat-slide-toggle>
      </div>
      <div fxFlex="20%" fxFlex.lt-sm="100" class="matero-col m-t-12">
        <mat-slide-toggle
          [disabled]="ShowDiscountAmount"
          color="primary"
          class="slide_toggle_style"
          formControlName="ShowDiscountAmount"
        >
          Show Discount Amount
        </mat-slide-toggle>
      </div>
    </div>
    <div class="matero-row" fxLayout.lt-sm="column" fxLayout="row">
      <div fxFlex="20%" fxFlex.lt-sm="100" class="matero-col m-t-12">
        <mat-slide-toggle
          [disabled]="ShowTaxableAmount"
          color="primary"
          class="slide_toggle_style"
          formControlName="ShowTaxableAmount"
        >
          Show Taxable Amount
        </mat-slide-toggle>
      </div>
      <div fxFlex="20%" fxFlex.lt-sm="100" class="matero-col m-t-12">
        <mat-slide-toggle
          color="primary"
          class="slide_toggle_style"
          formControlName="ShowTaxAmount"
        >
          Show Tax Amount
        </mat-slide-toggle>
      </div>
      <div fxFlex="20%" fxFlex.lt-sm="100" class="matero-col m-t-12">
        <mat-slide-toggle
          [disabled]="ShowGrossAmount"
          color="primary"
          class="slide_toggle_style"
          formControlName="ShowGrossAmount"
        >
          Show Gross Amount
        </mat-slide-toggle>
      </div>
      <div fxFlex="20%" fxFlex.lt-sm="100" class="matero-col m-t-12">
        <mat-slide-toggle
          [disabled]="ShowSchemeAmount"
          color="primary"
          class="slide_toggle_style"
          formControlName="ShowSchemeAmount"
        >
          Show Scheme Amount
        </mat-slide-toggle>
      </div>
      <div fxFlex="20%" fxFlex.lt-sm="100" class="matero-col m-t-12">
        <mat-slide-toggle
          color="primary"
          class="slide_toggle_style"
          formControlName="ShowNetAmount"
        >
          Show Net Amount
        </mat-slide-toggle>
      </div>
    </div>
    <mat-card-actions align="end" class="area-mat-card-actions">
      <button
        type="button"
        mat-raised-button
        color="accent"
        (click)="GenerateReport()"
      >
        Generate
      </button>
      <button
        type="button"
        mat-raised-button
        color="primary"
        (click)="ExportReport()"
      >
        Export
      </button>
    </mat-card-actions>
  </mat-card>
</form>
<mat-card>
  <div class="matero-row" fxLayout.lt-sm="column" fxLayout="row">
    <div fxFlex="100%" fxFlex.lt-sm="100" class="matero-col">
      <mtx-grid
        class="table-main-wrapper mtx-grid-sales-purchase-report"
        [data]="DataResponse"
        [columns]="columns"
        [multiSelectable]="false"
        [rowSelectable]="true"
        [hideRowSelectionCheckbox]="true"
        [pageOnFront]="false"
        [showPaginator]="false"
        [showToolbar]="false"
        [showSummary]="true"
        [showColumnMenuButton]="false"
        [summaryTemplate]="{
          amount: footerTpl,
          discountAmount: footerTpl,
          taxableAmount: footerTpl,
          igstAmount: footerTpl,
          cgstAmount: footerTpl,
          sgstAmount: footerTpl,
          cessAmount: footerTpl,
          totalTaxAmount: footerTpl,
          grossAmount: footerTpl,
          schemeAmount: footerTpl,
          netAmount: footerTpl
        }"
      >
      </mtx-grid>
    </div>
  </div>
</mat-card>

<ng-template #footerTpl let-data>
  <div class="right-mat-cell-summary">
    {{ getTotal(data) | number : "0.2-2" : "en-IN" }}
  </div>
</ng-template>
